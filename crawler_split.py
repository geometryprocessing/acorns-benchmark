name = "our_der_files/runnable_files/3D_P2_zero"



f = open(name+".c","r")
lines = f.readlines()
f.close()


split_by_len = 50
current_file = open(name+"_0.c","w")
counter = 1

header = 	"#include <assert.h>\n#include <time.h>\n#include <math.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n \
void compute(int num_points, double ders[], double grads[], double vjac_it[], double da[], double local_disp[]){\n\n \
int i=0;\n \
\tfor(int p = 0; p < num_points; ++p)\n\t{\n"

footer = "}}\n}}\n \
int main(int argc, char* argv[]){{ \n\
        int num_points = 11; \n\
        int ders_size = {}; \n\
        double ders[ders_size]; \n\
        double local_disp[30] = {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}}; \n\
        double grads[330] = {{0.301224, 0.301224, 0.301224, -0.838038, 0, 0, 0, -0.945757, 0, 0, 0, 2.08502, 0.536814, -0.161962, -0.161962, 0.0542428, 0.161962, 0, -0.0542428, 0.644533, -0.0542428, -3.08502, -3.08502, -2.38624, 3.08502, 0, 0.161962, 0, 3.08502, 0.0542428, 0.67438, 0.67438, 0.67438, 2.01003, 0, 0, 0, -0.727603, 0, 0, 0, -0.608051, -2.68441, -3.01003, -3.01003, 0.272397, 3.01003, 0, -0.272397, 0.0532222, -0.272397, -0.391949, -0.391949, -0.0663291, 0.391949, 0, 3.01003, 0, 0.391949, 0.272397, -1.96492, -1.96492, -1.96492, -0.731107, 0, 0, 0, -0.859264, 0, 0, 0, -0.374544, 2.69602, -0.268893, -0.268893, 0.140736, 0.268893, 0, -0.140736, 2.82418, -0.140736, -0.625456, -0.625456, 2.33946, 0.625456, 0, 0.268893, 0, 0.625456, 0.140736, 0.786635, 0.786635, 0.786635, 0.677065, 0, 0, 0, -0.808874, 0, 0, 0, 0.918444, -1.4637, -1.67707, -1.67707, 0.191126, 1.67707, 0, -0.191126, 0.0222392, -0.191126, -1.91844, -1.91844, -1.70508, 1.91844, 0, 1.67707, 0, 1.91844, 0.191126, -0.731814, -0.731814, -0.731814, 0.803064, 0, 0, 0, -0.762174, 0, 0, 0, -0.772704, -0.0712495, -1.80306, -1.80306, 0.237826, 1.80306, 0, -0.237826, 1.49399, -0.237826, -0.227296, -0.227296, 1.50452, 0.227296, 0, 1.80306, 0, 0.227296, 0.237826, -1.15203, -1.15203, -1.15203, -0.482355, 0, 0, 0, 0.320762, 0, 0, 0, -0.990436, 1.63438, -0.517645, -0.517645, 1.32076, 0.517645, 0, -1.32076, 0.831267, -1.32076, -0.00956403, -0.00956403, 2.14246, 0.00956403, 0, 0.517645, 0, 0.00956403, 1.32076, 0.964035, 0.964035, 0.964035, -0.513832, 0, 0, 0, 0.225976, 0, 0, 0, 1.25189, -0.450203, -0.486168, -0.486168, 1.22598, 0.486168, 0, -1.22598, -1.19001, -1.22598, -2.25189, -2.25189, -2.21593, 2.25189, 0, 0.486168, 0, 2.25189, 1.22598, 0.573583, 0.573583, 0.573583, -0.611181, 0, 0, 0, 1.73756, 0, 0, 0, -0.552797, 0.0375981, -0.388819, -0.388819, 2.73756, 0.388819, 0, -2.73756, -2.31114, -2.73756, -0.447203, -0.447203, -0.0207864, 0.447203, 0, 0.388819, 0, 0.447203, 2.73756, -0.316932, -0.316932, -0.316932, -0.881722, 0, 0, 0, 0.271614, 0, 0, 0, 0.293176, 1.19865, -0.118278, -0.118278, 1.27161, 0.118278, 0, -1.27161, 0.0453176, -1.27161, -1.29318, -1.29318, 0.0237559, 1.29318, 0, 0.118278, 0, 1.29318, 1.27161, 0.584624, 0.584624, 0.584624, 0.730841, 0, 0, 0, 0.415293, 0, 0, 0, -0.56151, -1.31546, -1.73084, -1.73084, 1.41529, 1.73084, 0, -1.41529, -0.999916, -1.41529, -0.43849, -0.43849, -0.0231132, 0.43849, 0, 1.73084, 0, 0.43849, 1.41529, -0.217794, -0.217794, -0.217794, -0.0388933, 0, 0, 0, -0.492793, 0, 0, 0, 0.313893, 0.256687, -0.961107, -0.961107, 0.507207, 0.961107, 0, -0.507207, 0.710587, -0.507207, -1.31389, -1.31389, -0.0960992, 1.31389, 0, 0.961107, 0, 1.31389, 0.507207}}; \n\
        double vjac_it[99] = {{-0.46634, -0.0298622, 0.65545, 0.282822, 0.851214, 0.161282, -1.65526, 1.02368, 0.264959, -0.46634, -0.0298622, 0.65545, 0.282822, 0.851214, 0.161282, -1.65526, 1.02368, 0.264959, -0.46634, -0.0298622, 0.65545, 0.282822, 0.851214, 0.161282, -1.65526, 1.02368, 0.264959, -0.46634, -0.0298622, 0.65545, 0.282822, 0.851214, 0.161282, -1.65526, 1.02368, 0.264959, -0.46634, -0.0298622, 0.65545, 0.282822, 0.851214, 0.161282, -1.65526, 1.02368, 0.264959, -0.46634, -0.0298622, 0.65545, 0.282822, 0.851214, 0.161282, -1.65526, 1.02368, 0.264959, -0.46634, -0.0298622, 0.65545, 0.282822, 0.851214, 0.161282, -1.65526, 1.02368, 0.264959, -0.46634, -0.0298622, 0.65545, 0.282822, 0.851214, 0.161282, -1.65526, 1.02368, 0.264959, -0.46634, -0.0298622, 0.65545, 0.282822, 0.851214, 0.161282, -1.65526, 1.02368, 0.264959, -0.46634, -0.0298622, 0.65545, 0.282822, 0.851214, 0.161282, -1.65526, 1.02368, 0.264959, -0.46634, -0.0298622, 0.65545, 0.282822, 0.851214, 0.161282, -1.65526, 1.02368, 0.264959}};\n\
        double da[11] = {{0.00597262, 0.00841063, 0.00842896, 0.00911969, 0.0105708, 0.0115892, 0.0120859, 0.0162006, 0.0167737, 0.0235818, 0.0294302}};\n\
        struct timespec tstart={{0,0}}, tend={{0,0}};\n\
        clock_gettime(CLOCK_MONOTONIC, &tstart);\n\
        compute(num_points, &ders, &grads, &vjac_it, &da, &local_disp);\n\
        clock_gettime(CLOCK_MONOTONIC, &tend);\n\
        double delta = ((double)tend.tv_sec + 1.0e-9*tend.tv_nsec) - ((double)tstart.tv_sec + 1.0e-9*tstart.tv_nsec); // seconds\n\
        FILE *fp;\n\
     \n\
 \n\
        fp = fopen(\"./results/us/hess/3D_P2_zero.txt\", \"w+\");\n\
        \n\
        printf(\"%f \", delta);\n\
        fprintf(fp, \"%f \", delta);\n\
\
\
        for(int i = 0; i < ders_size; i++) {{\n\
            fprintf(fp, \"%f \", ders[i]);\n\
        }}\n\
        fclose(fp);\n\
        return 0;\n\
    }}\n"

print(len(lines))
current_file.write(header)

for line in lines:
    if 'ders' in line and 'compute' not in line and line.count('ders')==1:
        counter+=1
        current_file.write(line)
    if counter % split_by_len == 0:
        current_file.write(footer.format(split_by_len))
        current_file.close()
        var = counter//split_by_len
        print(counter, split_by_len)
        current_file = open(name+"_{}.c".format(var),"w")
        current_file.write(header)

remainder = counter % split_by_len

current_file.write(footer.format(remainder))
current_file.close()

